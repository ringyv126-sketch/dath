sudo apt install ros-humble-teleop-twist-keyboard

ros2 run teleop_twist_keyboard teleop_twist_keyboard

ros2 topic echo /cmd_vel

cmdvel_to_serial.py

import rclpy
from rclpy.node import Node
from geometry_msgs.msg import Twist
import serial

class CmdVelSerial(Node):
    def __init__(self):
        super().__init__('cmdvel_serial')
        self.ser = serial.Serial('/dev/ttyUSB0', 115200, timeout=1)
        self.sub = self.create_subscription(
            Twist, '/cmd_vel', self.cmd_callback, 10)

    def cmd_callback(self, msg):
        if msg.linear.x > 0.1:
            self.ser.write(b'F:180\n')
        elif msg.linear.x < -0.1:
            self.ser.write(b'B:180\n')
        elif msg.angular.z > 0.1:
            self.ser.write(b'L:150\n')
        elif msg.angular.z < -0.1:
            self.ser.write(b'R:150\n')
        else:
            self.ser.write(b'S:0\n')

def main():
    rclpy.init()
    node = CmdVelSerial()
    rclpy.spin(node)
    rclpy.shutdown()

python3 cmdvel_to_serial.py

autodrive.py

import rclpy
from rclpy.node import Node
from sensor_msgs.msg import LaserScan
from geometry_msgs.msg import Twist
import math

class AutoDrive(Node):
    def __init__(self):
        super().__init__('auto_drive')
        self.sub = self.create_subscription(
            LaserScan, '/scan', self.scan_cb, 10)
        self.pub = self.create_publisher(Twist, '/cmd_vel', 10)

    def scan_cb(self, msg):
        front = msg.ranges[0:10] + msg.ranges[-10:]
        min_dist = min(front)

        cmd = Twist()

        if min_dist < 0.5:
            cmd.linear.x = 0.0
            cmd.angular.z = 0.6
        else:
            cmd.linear.x = 0.25
            cmd.angular.z = 0.0

        self.pub.publish(cmd)

def main():
    rclpy.init()
    node = AutoDrive()
    rclpy.spin(node)
    rclpy.shutdown()

//xe tao map
sudo apt install ros-humble-slam-toolbox

ros2 launch slam_toolbox online_async_launch.py

//Má»Ÿ RViz2:Add Map Add TF Add LaserScan

ros2 run nav2_map_server map_saver_cli -f my_map // luu map
